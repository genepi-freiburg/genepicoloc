% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene_annotation.R
\name{batch_annotate_positions}
\alias{batch_annotate_positions}
\title{Batch Annotate Multiple Genomic Positions}
\usage{
batch_annotate_positions(
  data,
  chr_col = "Chr",
  pos_col = "Pos",
  annotation_function,
  verbose = TRUE
)
}
\arguments{
\item{data}{Data frame with columns for chromosome and position}

\item{chr_col}{Character. Name of chromosome column (default: "Chr")}

\item{pos_col}{Character. Name of position column (default: "Pos")}

\item{annotation_function}{Function returned by setup_gene_annotation()$annotate_position}

\item{verbose}{Logical. Print progress messages (default: TRUE)}
}
\value{
Original data frame with added "Gene_Annotation" column
}
\description{
Efficiently annotate multiple genomic positions using gene annotation data.
This function adds gene annotations to a data frame containing genomic coordinates.
}
\examples{
\dontrun{
# First set up gene annotation
result <- setup_gene_annotation()

# Example 1: Simple batch annotation
my_variants <- data.frame(
  Chr = c("1", "2", "7", "17"),
  Pos = c(230000000, 169000000, 140453136, 41276113),
  Variant_ID = c("var1", "var2", "var3", "var4")
)

annotated <- batch_annotate_positions(
  data = my_variants,
  annotation_function = result$annotate_position
)
print(annotated)

# Example 2: Custom column names
gwas_data <- data.frame(
  chromosome = c("2", "4", "X"),
  bp_position = c(169127111, 88000000, 60000000),
  rsid = c("rs123", "rs456", "rs789"),
  pvalue = c(1e-8, 5e-7, 2e-6)
)

gwas_annotated <- batch_annotate_positions(
  data = gwas_data,
  chr_col = "chromosome",
  pos_col = "bp_position", 
  annotation_function = result$annotate_position
)
print(gwas_annotated$Gene_Annotation)

# Example 3: Large dataset processing
# For datasets with >10,000 variants, consider data.table for speed
if (require(data.table)) {
  large_data <- data.table(
    Chr = sample(c(1:22, "X"), 1000, replace = TRUE),
    Pos = sample(1:250000000, 1000),
    ID = paste0("variant_", 1:1000)
  )
  
  # This will be faster for large datasets
  large_data[, Gene := result$annotate_position(Chr, Pos), by = 1:nrow(large_data)]
}
}

}
