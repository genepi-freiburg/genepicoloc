% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genepicoloc_susie.R
\name{create_LD_matrix}
\alias{create_LD_matrix}
\title{Create LD matrix from genotype data using PLINK2}
\usage{
create_LD_matrix(
  sumstats,
  bfile,
  fixref = FALSE,
  keep = NULL,
  plink2 = "plink2",
  Name_var = "Name",
  A1_var = "A1"
)
}
\arguments{
\item{sumstats}{Data.frame containing variant information with columns
specified by Name_var and optionally A1_var.}

\item{bfile}{Character string. Path to PLINK binary fileset (without extension).
Files .bed, .bim, and .fam must exist.}

\item{fixref}{Logical. Whether to fix reference alleles to match sumstats
(default: FALSE). If TRUE, ensures LD calculations use the same effect allele.}

\item{keep}{Character string. Path to file with sample IDs to include
(PLINK --keep format). Default: NULL (use all samples).}

\item{plink2}{Character string. Path to PLINK2 executable (default: "plink2").}

\item{Name_var}{Character string. Column name for variant identifiers
(default: "Name").}

\item{A1_var}{Character string. Column name for effect allele when fixref=TRUE
(default: "A1").}
}
\value{
A numeric matrix with variants as both row and column names.
Values are correlation coefficients between -1 and 1.
Variants with missing data are removed.
}
\description{
Calculates a linkage disequilibrium (LD) correlation matrix for a set of
variants using PLINK2. Handles reference allele alignment and missing data.
}
\details{
The function:
\enumerate{
\item Extracts specified variants from the PLINK dataset
\item Optionally aligns reference alleles with summary statistics
\item Calculates unphased correlation matrix
\item Removes variants with any missing correlations
\item Cleans up temporary files
}

Missing data handling:
\itemize{
\item Warns if >20\% of variants have missing correlations
\item Stops if >80\% of variants have missing correlations
\item Suggests using --geno and --mind filters if missingness is high
}
}
\examples{
\dontrun{
# Basic LD matrix calculation
ld_matrix <- create_LD_matrix(
  sumstats = my_sumstats,
  bfile = "data/genotypes/chr1"
)

# With reference allele correction
ld_matrix <- create_LD_matrix(
  sumstats = my_sumstats,
  bfile = "data/genotypes/chr1",
  fixref = TRUE
)

# Using specific samples
ld_matrix <- create_LD_matrix(
  sumstats = my_sumstats,
  bfile = "data/genotypes/chr1",
  keep = "data/samples_european.txt"
)
}

}
