% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gene_annotation.R
\name{annotate_position}
\alias{annotate_position}
\title{Annotate a genomic position with gene information}
\usage{
annotate_position(chr, pos, gene_map, n_nearest = 2, output_format = "default")
}
\arguments{
\item{chr}{Character or numeric. Chromosome (1-22, X)}

\item{pos}{Numeric. Genomic position in base pairs}

\item{gene_map}{Data frame. Gene map from setup_gene_annotation()}

\item{n_nearest}{Integer. Number of nearest genes to return for intergenic positions (default: 2)}

\item{output_format}{Character. Output format: "default", "simple", or "detailed" (default: "default")}
}
\value{
Character string with gene annotation
}
\description{
Annotate a genomic position with gene information
}
\details{
For genic positions (position within a gene), returns the gene name(s).
For intergenic positions, behavior depends on n_nearest:
\itemize{
\item n_nearest = 1: Returns closest gene only
\item n_nearest = 2: Returns upstream and downstream genes (default behavior)
\item n_nearest > 2: Returns N closest genes with distances
}

Output formats:
\itemize{
\item "default": Standard format with distances (e.g., "INTERGENIC: upstream=GENE1(+1000bp), downstream=GENE2(-500bp)")
\item "simple": Gene names only, comma-separated (e.g., "GENE1, GENE2, GENE3")
\item "detailed": Genes with distances, comma-separated (e.g., "GENE1(+1000bp), GENE2(-500bp), GENE3(+2000bp)")
}
}
\examples{
\dontrun{
# Setup gene annotation first
result <- setup_gene_annotation()

# Standard usage
annotate_position("1", 1000000, gene_map = result$gene_map)

# Or in one line
annotate_position("1", 1000000, gene_map = setup_gene_annotation()$gene_map)

# Get 5 nearest genes in simple format
annotate_position("1", 1000000, gene_map = result$gene_map, 
                  n_nearest = 5, output_format = "simple")

# Get 3 nearest genes with detailed distances
annotate_position("1", 1000000, gene_map = result$gene_map, 
                  n_nearest = 3, output_format = "detailed")

# Get 10 nearest genes (default format)
annotate_position("1", 1000000, gene_map = result$gene_map, n_nearest = 10)
}

}
