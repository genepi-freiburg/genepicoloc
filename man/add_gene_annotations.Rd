% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/colocalization.R
\name{add_gene_annotations}
\alias{add_gene_annotations}
\title{Add gene annotations to colocalization results}
\usage{
add_gene_annotations(result, gene_map = NULL, verbose = FALSE)
}
\arguments{
\item{result}{A data.frame with region information (CHR_var, BP_START_var, BP_STOP_var).}

\item{gene_map}{Data.frame with gene annotations from setup_gene_annotation()$gene_map.
If NULL, attempts to use packaged gene data.}

\item{verbose}{Logical. Print gene annotation details (default: FALSE).}
}
\value{
The input data.frame with added gene annotation columns:
\itemize{
\item region_center_pos: Center position of the region
\item region_center_gene: Gene annotation at region center
\item nearest_genes_3: 3 nearest genes (simple format)
\item nearest_genes_5: 5 nearest genes (simple format)
\item nearest_genes_10: 10 nearest genes (simple format)
}
}
\description{
Annotates genomic regions with nearest genes using the gene annotation
system. Adds multiple gene annotation fields to provide context for
colocalization results.
}
\details{
This function:
\enumerate{
\item Calculates the center position of the genomic region
\item Annotates the center position with the nearest gene
\item Finds multiple nearest genes for broader context
\item Uses simple gene name format for easy interpretation
}
}
\examples{
\dontrun{
# Prepare gene annotation
gene_setup <- setup_gene_annotation()

# Create a result template
result <- create_result_template(
  CHR_var = "1", BP_START_var = 1000000, BP_STOP_var = 2000000,
  sumstats_1_file = "file1", sumstats_2_file = "file2",
  sumstats_1_tabix = "ok", sumstats_2_tabix = "ok"
)

# Add gene annotations
result_annotated <- add_gene_annotations(result, gene_setup$gene_map)
}

}
\seealso{
\code{\link{annotate_position}} for the underlying annotation function
\code{\link{setup_gene_annotation}} for gene map preparation
}
