% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/colocalization.R
\name{add_gene_annotations}
\alias{add_gene_annotations}
\title{Add gene annotations to colocalization results}
\usage{
add_gene_annotations(
  result,
  gene_map = NULL,
  verbose = FALSE,
  nearest = c(1, 10)
)
}
\arguments{
\item{result}{A data.frame with region information (CHR_var, BP_START_var, BP_STOP_var).}

\item{gene_map}{Data.frame with gene annotations from setup_gene_annotation()$gene_map.
If NULL, attempts to use packaged gene data.}

\item{verbose}{Logical. Print gene annotation details (default: FALSE).}

\item{nearest}{Numeric vector. Number of nearest genes to annotate for each region
(default: c(1, 10)). Creates one column per value.}
}
\value{
The input data.frame with added gene annotation columns:
\itemize{
\item region_center_pos: Center position of the region
\item nearest_genes_N: N nearest genes for each value in 'nearest' parameter
}
For example, with nearest = c(1, 10), creates nearest_genes_1 and nearest_genes_10.
}
\description{
Annotates genomic regions with nearest genes using the gene annotation
system. Adds multiple gene annotation fields to provide context for
colocalization results.
}
\details{
This function:
\enumerate{
\item Calculates the center position of the genomic region
\item Finds the specified number of nearest genes for each value in 'nearest'
\item Uses appropriate format: detailed for single gene, simple for multiple
}
}
\examples{
\dontrun{
# Default: 1 and 10 nearest genes
result_annotated <- add_gene_annotations(result, gene_setup$gene_map)

# Custom: 1, 5, and 20 nearest genes
result_annotated <- add_gene_annotations(result, gene_setup$gene_map, 
                                         nearest = c(1, 5, 20))
}

}
\seealso{
\code{\link{annotate_position}} for the underlying annotation function
\code{\link{setup_gene_annotation}} for gene map preparation
}
