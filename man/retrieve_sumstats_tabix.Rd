% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocessing.R
\name{retrieve_sumstats_tabix}
\alias{retrieve_sumstats_tabix}
\title{Extract GWAS summary statistics from tabix-indexed file}
\usage{
retrieve_sumstats_tabix(
  sumstats_file,
  coloc_regions_PASS,
  sumstats_pheno = "single",
  verbose = FALSE,
  test_mode = FALSE,
  file_remove = TRUE,
  return_tabix_cmd = FALSE
)
}
\arguments{
\item{sumstats_file}{Character string. Path to a tabix-indexed (.gz + .tbi)
summary statistics file.}

\item{coloc_regions_PASS}{A data.frame with columns CHR_var, BP_START_var,
and BP_STOP_var defining genomic regions to extract.}

\item{sumstats_pheno}{Character string. Either "single" for single phenotype
or "multiple" for multi-phenotype data (default: "single").}

\item{verbose}{Logical. Whether to print progress messages (default: FALSE).}

\item{test_mode}{Logical. If TRUE, only process the first region (default: FALSE).}

\item{file_remove}{Logical. Whether to remove temporary files (default: TRUE).}

\item{return_tabix_cmd}{Logical. If TRUE, return the tabix command instead of
executing it (default: FALSE).}
}
\value{
A sumstats object (data.table) with attributes:
\itemize{
\item tabix: Status ("tabix_ok", "tabix_ok_no_data", or "tabix_failed")
\item sumstats_file: Path to the source file
\item coloc_regions_PASS: Regions that were queried
\item sumstats_pheno: Phenotype type
}
}
\description{
Retrieves summary statistics from a tabix-indexed file for specified
genomic regions. This is the primary method for accessing large GWAS
files efficiently.
}
\details{
The function:
\enumerate{
\item Creates a temporary file with region coordinates
\item Uses tabix to extract data for these regions
\item Parses the output using data.table::fread
\item Sets appropriate status attributes
}

Tabix status codes:
\itemize{
\item "tabix_ok": Data successfully retrieved
\item "tabix_ok_no_data": Query successful but no data in regions
\item "tabix_failed": Query failed (file not found, not indexed, etc.)
}
}
