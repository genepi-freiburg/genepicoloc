% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/name_by_position.R
\name{genepi_liftover}
\alias{genepi_liftover}
\title{Genomic Coordinate Lift Over with Variant Harmonization}
\usage{
genepi_liftover(
  sumstats,
  CHR_name,
  POS_name,
  A1_name,
  A2_name,
  liftOver_bin = "liftOver",
  liftOver_chain,
  dbSNP_file = NULL,
  tabix_bin = "/usr/bin/tabix",
  mc_cores = 4,
  keep_lower = FALSE,
  do_sorting = TRUE,
  rm_tmp_liftOver = TRUE,
  do_name_by_position = TRUE
)
}
\arguments{
\item{sumstats}{A data.table containing summary statistics with genomic coordinates}

\item{CHR_name}{Character. Column name for chromosome}

\item{POS_name}{Character. Column name for genomic position}

\item{A1_name}{Character. Column name for first allele}

\item{A2_name}{Character. Column name for second allele}

\item{liftOver_bin}{Character. Path to liftOver binary (default: "liftOver")}

\item{liftOver_chain}{Character. Path to liftOver chain file}

\item{dbSNP_file}{Character. Path to dbSNP file for name harmonization (optional)}

\item{tabix_bin}{Character. Path to tabix binary (default: "/usr/bin/tabix")}

\item{mc_cores}{Integer. Number of CPU cores for parallel processing (default: 4)}

\item{keep_lower}{Logical. Whether to keep lowercase alleles (default: FALSE)}

\item{do_sorting}{Logical. Whether to sort output by position (default: TRUE)}

\item{rm_tmp_liftOver}{Logical. Whether to remove temporary files (default: TRUE)}

\item{do_name_by_position}{Logical. Whether to perform name harmonization (default: TRUE)}
}
\value{
A data.table with lifted coordinates in new columns:
\itemize{
\item \strong{CHR_hg38}: Chromosome in target build
\item \strong{POS_hg38}: Position in target build
\item \strong{A1_hg38}: First allele (strand-flipped if necessary)
\item \strong{A2_hg38}: Second allele (strand-flipped if necessary)
\item \strong{Name_hg38}: Standardized variant names (if do_name_by_position=TRUE)
\item \strong{rs}: dbSNP identifiers (if do_name_by_position=TRUE)
}
}
\description{
Performs genomic coordinate conversion between genome builds (e.g., hg19 to hg38)
using UCSC liftOver tool, with optional variant name harmonization via dbSNP.
}
\details{
This function performs comprehensive genomic coordinate conversion:
\enumerate{
\item Validates input data and required external tools
\item Converts coordinates using UCSC liftOver
\item Handles strand flipping for negative strand variants
\item Optionally harmonizes variant names using dbSNP
\item Returns cleaned data with new genomic coordinates
}

Variants that cannot be lifted over are automatically removed with a summary
of the number of failed variants.
}
\section{Required Tools}{


\strong{liftOver Binary:}
Download from UCSC Genome Browser:
\url{https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/liftOver}

\strong{Chain Files:}
Download appropriate chain file from:
\url{https://hgdownload.soe.ucsc.edu/goldenPath/hg19/liftOver/}

Common chain files:
\itemize{
\item hg19 to hg38: \code{hg19ToHg38.over.chain.gz}
\item hg18 to hg38: \code{hg18ToHg38.over.chain.gz}
\item hg38 to hg19: \code{hg38ToHg19.over.chain.gz}
}

\strong{Installation:}
\preformatted{
# Download liftOver binary
wget https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/liftOver
chmod +x liftOver

# Download chain file
wget https://hgdownload.soe.ucsc.edu/goldenPath/hg19/liftOver/hg19ToHg38.over.chain.gz
}
}

\section{dbSNP File Setup}{

For variant name harmonization, you need a processed dbSNP file. See
\code{\link{name_by_position}} for details on file format and creation.
}

\examples{
\dontrun{
# Basic liftOver from hg19 to hg38
library(data.table)

# Sample data in hg19 coordinates
sumstats_hg19 <- data.table(
  CHR = c("1", "2", "3"),
  POS = c(1000000, 2000000, 3000000),
  A1 = c("A", "G", "T"),
  A2 = c("G", "C", "C"),
  PVAL = c(1e-8, 1e-6, 1e-5)
)

# Perform liftOver
sumstats_hg38 <- genepi_liftover(
  sumstats = sumstats_hg19,
  CHR_name = "CHR",
  POS_name = "POS", 
  A1_name = "A1",
  A2_name = "A2",
  liftOver_bin = "path/to/liftOver",
  liftOver_chain = "path/to/hg19ToHg38.over.chain.gz"
)

# Check results
print(sumstats_hg38)
}

}
