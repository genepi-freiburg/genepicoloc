% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/colocalization.R
\name{genepicoloc_job}
\alias{genepicoloc_job}
\title{Process a single job of colocalization analyses}
\usage{
genepicoloc_job(
  sumstats_1_form,
  args_df,
  tar_sumstats_file,
  tar_coloc_file,
  mc_cores = 10,
  verbose = TRUE,
  debug_mode = FALSE,
  save_sumstats = FALSE,
  p_filt = 0.05,
  p_min_save = 5e-08
)
}
\arguments{
\item{sumstats_1_form}{Formatted primary dataset for this job's regions.}

\item{args_df}{Data frame subset with secondary datasets to process.}

\item{tar_sumstats_file}{Path to tar archive for storing sumstats.}

\item{tar_coloc_file}{Path to tar archive for storing coloc results.}

\item{mc_cores}{Integer. Cores for parallel processing (default: 10).}

\item{verbose}{Logical. Print progress messages (default: TRUE).}

\item{debug_mode}{Logical. Run sequentially (default: FALSE).}

\item{save_sumstats}{Logical. Whether to save filtered summary statistics
(default: FALSE). Set to TRUE only if you need the filtered summary statistics
for downstream analyses like fine-mapping. WARNING: This substantially increases
disk usage (~20-30GB per 1,00 regions and 10,000 datasets with typical settings).
When FALSE, only colocalization results are saved (~2-3GB).}

\item{p_filt}{Numeric. Maximum p-value threshold for variants to include in
saved summary statistics (default: 1, includes all variants). Only applies
when save_sumstats = TRUE. Set to a lower value (e.g., 0.05) to reduce
storage by excluding variants with high p-values. Note: For fine-mapping
and conditional analyses, keep at 1 to preserve complete LD structure.}

\item{p_min_save}{Numeric. Minimum p-value threshold for saving summary
statistics sumstats_2 (default: 5e-8). Only regions with at least one variant
with p-value below this threshold will be saved when save_sumstats is TRUE}
}
\value{
List with two elements:
\itemize{
\item n_sumstats: Number of sumstats files processed
\item n_coloc: Number of coloc result files created
}
}
\description{
Processes a subset of secondary datasets against a primary dataset for a
specific set of regions. Manages temporary file creation, parallel processing
of datasets, and archiving of results.
}
\details{
This function:
\enumerate{
\item Creates temporary directories for intermediate files
\item Processes each secondary dataset via genepicoloc_run
\item Archives results into tar files
\item Cleans up temporary directories
}

The function uses mapply/mcmapply for parallel processing based on
debug_mode setting. Results are appended to existing tar archives,
allowing incremental processing across multiple calls.
}
\examples{
\dontrun{
result <- genepicoloc_job(
  sumstats_1_form = formatted_primary_data,
  args_df = args_subset,
  tar_sumstats_file = "output/sumstats.tar",
  tar_coloc_file = "output/coloc.tar",
  mc_cores = 4
)

# Check processing status
if (result$n_sumstats != nrow(args_subset)) {
  warning("Some datasets failed to process")
}
}

}
